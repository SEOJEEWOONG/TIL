# 컴퓨터 네트워크 기본

> 작성 날짜 : 2021-11-29


## 컴퓨터 네트워크 기본 용어

* 트래픽 : 서버를 통해 최종 사용자에게 전달된 데이터의 양 = 용량 * 사용자수 * 데이터 갯수
* Host : 고유 IP 주소를 가진 장치
* Node : 컴퓨터 네트워크 상에 연결된 장치
* Link : 물리적으로 노드와 노드를 연결하는 장치
* Hop : 거리의 단위, 한 링크를 이동하면 한 홉
* 경로 : 네트워크 상의 두 노드 간의 이동 경로
* 프로토콜 : 데이터 통신을 원활하게 하기 위해 필요한 통신 규약
* 포트 : 외부의 다른 서비스나 프로세스와 접속하기 위한 플러그 같은 것, 네트워크 서비스나 특정 프로세스를 식별하는 논리 단위
* IP 주소 : Node를 찾을 때 필요한 주소
* 인트라넷 : 단체의 직원만 접근 가능한 사설망으로 인터넷 프로토콜을 쓰는 폐쇄적 근거리 통신망
* 웹 : 인터넷에 연결된 다수의 사용자가 로그인 절차 없이 접근할 수 있는 서비스
* 웹 브라우저 : http 또는 https 프로토콜에 지정된 포트를 통해 서버와 연결 시도
* URL : 서버의 자원 명칭 -> 클라이언트가 웹 서버를 지칭할 때 사용하는 주소, 프로토콜 + 서버 호스트 이름 + 서버 내부 파일 경로명
* PHP : 서버사이드 스크립트 언어로 수많은 웹사이트의 기반언어 -> 리툭스 배포본에 PHP 설치 패키지가 기본으로 제공하여 거의 모든 웹 서버에서 실행 가능
* 스크립트 언어: 응용 소프트웨어를 제어하는 컴퓨터 프로그래밍 언어 -> 다른 응용 프로그램에 삽입되어서 동작하는 프로그램 언어
* Javascript : HTML 문서에 삽입되어 실행되는 스크립트 언어
* JSP(Java Server Page) : HTML 문서 안에 자바 코드를 직접 삽입하여 웹 서버에서 동적으로 웹 페이지 생성하여 표현하는 스크립트 언어
* Python : 객체 지향 스클립트 프로그래밍 언어. 컴파일 과정이 필요 없어 개발 기간이 단축되고 OS에 독립적임
* 비스크립트 언어 : C,C++,JAVA 등 컴파일 된 후 독립적으로 작동하는 완전한 응용 프로그램
* Apache : 웹 서버 프로그램
* APM : Apache, PHP, Mysql
    - 동작 원리
        1) 웹 브라우저가 아파치에 웹 문서 요청
        2) PHP 코드가 존재하면 처리를 위해 PHP 요청
        3) 데이터베이스 처리가 필요한 경우 MYSQL 요청
        4) 아파치가 웹 브라우저에 데이터베이스 결과와 PHP 실행 결과인 HTML 코드 회신
* 대칭키 : 암호화와 복호화에 같은 암호키(대칭키)를 사용하는 방식
    - 장점 : 동일한 키를 주고 받기 때문에 매우 빠르다.
    - 단점 : 대칭키 전달 과정에서 해킹 위험
* 공개키 : 암호화와 복호화에 사용하는 암호키 분리하는 방식
    - 설명
        - 서버가 가지고 있는 고유한 비밀키로만 복호화할 수 있는 공개키를 대중에 공개
        - 서버가 웹 상에 공개한 공개키를 이용해 클라이언트는 평문을 암호화해서 서버에게 전달
        - 서버는 개인키로 암호화된 평문 복호화
        - 서버는 응답 데이터를 공개키로 암호화하여 클라이언트에게 전달
        - 클라이언트는 공개키로 복호화하여 데이터 확인
* 세션 : 웹 사이트의 여러 페이지에 걸쳐 사용되는 사용자 정보를 저장하는 방법
    - 사용자가 브라우저를 닫아 서버와의 연결을 끝내는 시점까지 세션
    - 서비스가 돌아가는 서버 측에 데이터를 저장하고 세션의 키 값만을 클라이언트 측에 남겨둔다
    - 브라우저는 키 값을 활용해 서버에 저장된 데이터를 활용한다.



**OSI 모델**
1. 계층을 나눈 이유

    한 프로토콜에서 통신 과정을 모두 처리하면 문제가 발생하기 쉽다 -> 프로토콜을 모듈화하여 특정 단위의 모듈들은 독립적이지만 상호 유기적인 관계
    프로토콜(통신 규약)을 계층마다 구별시켜주는 역할
    하위 계층의 기능을 이용해서 상위 계층에게 제공하는 역할
    특정 계층에서의 오류를 찾아내고 네트워크 통신 과정을 직관적으로 구분해주는 역할
    송신 측 n 계층 ---------- 수신 측 n 계층 끼리만 논리적으로 통신한다. 이 떄의 규칙이 n 계층 프로토콜

2. 응용 계층 : 하부 계층들을 이용해 사용자에게 편리한 응용 환경을 제공하는 계층 -> 응용 프로세스와 관계하여 애플리케이션에 대한 서비스 제공
    - 예시 : HTTP, HTTPS, FTP, DNS, SMTP
        - HTTP : 클라이언트 요청과 서버의 응답정보를 하이퍼텍스트형태로 전송하기 위한 프로토콜
            - 클라이언트 -> 서버 : GET, 서버 -> 클라이언트 : POST
            - 비상태연결 : 요청과 응답 이후에 연결이 끊어짐
            - 요청 메시지 = 요청 메서드 + URL + HTTP 버전
                - 요청 메서드
                    - GET : URL이 가리키는 웹 문서 전송 요청
                    - HEAD : 문서 내용보다는 특정 문서에 대한 정보 요청
                    - POST : 클라이언트 또는 서버가 상대에게 정보 전달
                    - PUT : 클라이언트가 서버에게 문서 전달
            - 응답문 = 상태문 + 헤더 + 바디
                - 상태문 : HTTP 버전 + 상태 코드 + 상태 이름
        - HTTPS : 인터넷 상에서 정보를 암호화하는 TLS 방식을 사용해 클라이언트와 서버가 자원을 주고받는 프로토콜
            - HTTPS 통신 과정
                1) 서버는 HTTPS 적용을 위해 공개키와 개인키를 만든다.
                2) 신뢰할 수 있는 CA기업을 선택하고, 그 기업에서 내 공개키 관리를 부탁하며 계약
                3) 계약 완료된 CA기업은 해당 기업의 이름, 서버 공개키, 공개키 암호화 방법을 담은 인증서를 만들고 CA 기업 개인키로 암호화된 인증서를 서버에게 전달
                4) 클라이언트가 서버에게 데이터 요청하면 인증서를 클라이언트에게 건네준다.
                5) 클라이언트의 브라우저는 인증서를 CA기업에게 전달하여 서버 공개키를 얻는다
                6) 클라이언트는 서버 공개키로 암호화하여 서버에게 데이터 전달
            - TLS HANDSHAKE : HTTPS 프로토콜에서 서버간 통신전 TLS 인증서로 신뢰성 여부 판단
                1) 클라이언트 -> 서버 : 메시지 + 버전 + 압축방식 전달
                2) 서버 -> 클라이언트 : 세션 ID + CA 공개 인증서 + 메시지 전달
                3) 클라이언트 : 서버에서 보낸 CA 공개 인증서가 유효한지 확인
                4) 클라이언트 : CA 인증서 신뢰성 확보되면 난수 바이트 생성하여 서버의 공개키(대칭키)로 암호화
                5) 클라이언트 -> 서버: 대칭키로 HANDSHAKE 완료 메시지 + 교환 내역 암호화하여 전송
                6) 서버 : 난수 바이트를 개인키로 복호화 후 대칭 키 생성에 활용
                7) 서버 -> 클라이언트 : HANDSHAKE 완료 메시지 + 교환 내용 대칭키로 암호화하여 전송
                8) 클라이언트 : 메시지 대칭키로 복호화하여 통신이 가능한 신뢰받은 사용자란 걸 인지하고 대칭키로 데이터를 주고받는다.
        - DNS : 숫자 주소를 사람들이 기억하기 쉬운 문자로 된 호스트 이름을 부여하는 도메인 관리 도구 (해석기 + 네임 서버)
            - 위임과 계층적 도메인 이름을 이용하여 도메인을 관리
            - ROOT에서 하부로 위임을 하고 TLD인 최상위 도메인에서 하위로 계속 위임해나가면서 도메인 이름을 트리형 구조로 관리
                - 도메인 이름 = 점으로 구분한 레이블의 연속
                - TLD : 최상위 도메인으로 루트 바로 밑에 위치한 레이블로 도메인 이름의 맨 오른쪽에 위치
                - 자신의 도메인에 포함된 모든 레이블에 관한 정보를 유지, 다른 도메인에 속한 레이블 정보는 네임 서버를 통해 요청
            - 위임받은 기관에서 자신의 도메인에 속한 호스트 이름, IP주소 관리
            - 계층 구조를 지원하는 도메인 기반의 주소 표기 방법을 위한 분산 데이터베이스 시스템으로 도메인 이름에서 IP주소를 얻는 것
                1) IP주소를 얻고자 하는 응용 프로그램이 호출되면 응용 프로그램은 해석기에게 도메인 이름 전달
                2) 해석기는 DNS 프로토콜을 이용해서 DNS 서버에 반환 요청
            - 네임 서버 : 네임 스페이스의 트리 구조와 트리에 보관된 정보 집합체를 관리하는 프로그램
            - 호스트는 레이블을 이름으로 갖는다.
        - FTP : 인터넷에 연결된 호스트 간의 파일 복사 기능을 제공하여 원격 시스템과의 파일 송수신 기능을 지원
            - 클라이언트는 프로그램을 이용하여 ftp 서버에 접속하여 파일을 다운로드 또는 업로드
            - GET은 FTP 서버에서 파일 수신 // PUT은 FTP 서버로 파일 송신
            - 제어 채널
                - FTP 프로토콜의 명령과 응답 전송
                - 클라이언트가 초기화
                - TCP 21번 PORT 주로 이용
            - 데이터 채널
                - 복사하려는 파일의 내용 전송
                - 서버가 초기화
                - TCP 20번 PORT
                - 데이터 채널 설정 순서
                    1) 송수신을 위한 포트 생성
                    2) 포트 번호를 서버에 전송
                    3) 파일 송수신 명령 전송
                    4) 서버가 연결 설정 요구
                    5) 파일 데이터 송신
                    6) 데이터 전송하고 채널 종료
                    7) 서버에서 응답 코드 전송
            - 인터페이스 모듈 : 사용자 명령을 해석하여 명령 송수신 모듈에 전달
            - 명령 송수신 모듈 : 제어 채널을 설정하고 사용자 명령을 FTP 프로토콜 명령으로 전환하여 제어 채널로 전송
            - 파일 송수신 모듈 : 파일 송수신 요구가 발생할 때마다 데이터 채널을 설정하여 파일 복사, 파일 목록 전송 기능 수행
    - 클라이언트 - 서버 모델 : 하나의 서버 프로그램이 다수의 클라이언트에 응용 서비스를 제공하는 모델
        - 클라이언트와 서버가 연결되는 과정
            1) 사용자가 웹 브라우저에게 웹 서버 URL 주소 입력
            2) 웹 브라우저가 DNS 서버에게 웹 서버 호스트 이름을 IP주소로 변경 요청
            3) 웹 브라우저가 IP 주소와 포트 번호(80)를 이용하여 웹서버와 TCP 연결 시도
            4) 웹 브라우저가 최초 화면을 위한 GET 명령 전송하면 웹 서버가 웹 브라우저에게 요청한 웹 문서를 회신
            5) 웹 브라우저와 웹 서버 연결 해제하고 브라우저가 사용자 화면에 웹 문서 출력

3. 표현 계층 : 송신 프로세스가 전달하는 의미를 수신 프로세스가 정확히 이해하도록 메시지 표현 및 해석-> 코드, 암호화 등 데이터 변환 + 데이터 형식 상의 차이를 다루는 코드 간의 번역 제공
    - 예시 : JPG, MPEG, MIME
    - 기능
        - 추상 문법 : 컴퓨터에서 사용하는 데이터 표현 규칙
            - 수신 측에서는 자신의 컴퓨터에서 이해하는 추상 문법의 형태로 다시 변환하는 과정 필요
        - 전송 문법 : 네트워크 전체에서 일관성을 지니는 표현 규칙
        - 데이터 압축 : 전송 데이터의 양을 줄이는 목적

4. 세션 계층 : 양 끝단의 프로세스가 통신을 관리하는 방법 제공 (동기 기능, 대화 기능)
    - 예시 : SSH, NETBIOS
    - 기능
        - 동기 기능 : 통신 양단 끼리 서로 동의하는 논리적인 공통 시점인 동기점을 만들어 메시지가 제대로 처리 되고 있는 지를 파악
            - 동기점은 오류 복구를 위하여 필수적으로 사용되는데, 동기점 설정 이전까지는 서로 처리가 완료되었음을 합의
            - 동기점 이전 과정은 복구가 필요 없고, 동기점 이후 처리 과정에 대한 복구 절차가 진행
        - 대화 기능 : 데이터 전송 과정 제어
            - 시간 경과에 따라 순차적으로 동기점을 부여하여 신뢰성 보장 기능을 단계적으로 구현
            - 토큰 : 두 응용 프로세스의 데이터 전송 과정을 관리
                - 토큰의 보유는 해당 토큰에 부여된 특정 권리를 배타적으로 소유
                - 데이터 토큰 : 데이터 전송할 수 있는 권한
                - 해제 토큰 : 통신 양단 사이의 연결 해제 제어
                - 동기 토큰 : 동기 처리가 필요한 시점에 사용

5. 전송 계층 : 송신 프로세스와 수신 프로세스 간의 연결 기능
    - 예시 : TCP, UDP
        - TCP : 연결형 서비스를 지원하는 프로토콜 -> 신뢰성 있는 데이터 전송
            - 세그먼트 = 송신/수신 Port + 순서 번호 + 응답 번호 + 윈도우 크기(버퍼 크기) + 체크섬(헤더와 데이터에 대한 오류 검출)
            - 3 Way Handshaking 연결 설정
                - 응용 프로그램이 데이터를 전송하기 전에 세션을 수립하는 과정
                    - 세션 : 네트워크의 두 노드의 활성화된 접속
                - 3 Way Handshaking 연결 과정
                    1) Client > Server : TCP SYN 패킷 전송 
                    2) Server > Client : ACK 신호(요청 수락)와 SYN Flag가 설정된 패킷 전송, Server : SYN_Received
                    3) Client > Server : ACK 신호 보냄 => 데이터 송수신 시작
            - 4 Way Handshaking 연결 해제 과정
                1) Client > Server : FIN 플래그 전송
                2) Server > Client : ACK 전송, Server : Time_Wait
                3) Server > Cleint : 본인의 데이터 통신(송/수신) 끝나고 FIN 플래그 전송
                4) Client > Server : FIN 플래그 전송 => 연결 해제
                
        - UDP : 비연결형 서비스를 지원하는 프로토콜 -> 스트리밍 서비스에 적합
            - 데이터그램 = 송신/수신 Port + 데이터그램 크기 + 체크섬
            - 장점 : 헤더가 간단하고, 용량이 가볍고, 송신 속도가 빠르게 작동
            - 단점 : 확인 응답을 못해서 데이터 순서가 바뀌거나 손실 발생
            - 쓰이는 곳 : DNS(Request 양이 작고, Request에 대한 손실은 Application에서 제어 가능), 실시간 방송 및 온라인 게임
    - 단위 : 세그먼트, 데이터그램 : 데이터 + TCP 헤더
    - 기능 : 프로세스마다 포트 할당 및 관리, 사용자는 소켓 인터페이스를 시스템 콜하여 활용
        - 소켓 : 각자 고유한 포트 번호를 담당.
            - 소켓 함수 : 매개변수로 지정한 유형에 따라 소켓을 생성하고 생성된 소켓을 가리키는 파일 디스크립터 리턴
                - 파일 디스크립터 : 유닉스 계열의 시스템에서 프로세스가 파일을 다룰 때 사용하는 개념, 프로세스에서 특정 파일에 접근할 때 사용하는 추상적인 값
                - bind 함수 : 소켓에 소켓 주소를 할당
                - listen 함수 : 소켓 활성화
                - accpet 함수 : 서버가 클라이언트의 수신 신호 대기
                - connect 함수 : 클라이언트가 서버 신호 응답
                - send 함수 : 연결이 설정된 소켓에 데이터를 송신한다.
                - recv 함수 : 연결이 설정된 소켓에서 데이터를 수신한다.
                - 수신 데이터는 buf가 가리키는 공간에 저장
        - 흐름 제어 : 송수신 호스트의 전송 과정의 속도 차이 제어
            - 버퍼 관리 : 버퍼 크기를 조절하여 네트워크 전송 효율 및 데이터 손실 최적화
        - 혼잡 제어 : 송신 측의 데이터 전달과 네트워크의 데이터 처리 속도 차이를 해결하기 위한 기법
            - 한 라우터에 데이터가 몰릴 경우, 자신에게 온 데이터를 모두 처리할 수 없게 되고, 호스트들은 데이터를 재전송하면서 혼잡만 가중되어 오버플로우 발생
                - 오버플로우 : 감당할 수 잇는 메모리보다 더 큰 데이터가 저장될 경우, 데이터 손실 발생
        - 오류 제어 : 데이터 변형, 데이터 분실 오류 시 재전송 기능으로 복구 수행
        - 주소 = 네트워크 계층의 HOST IP 주소 + 포트 번호

6. 네트워크 계층 : 네트워크의 다른 호스트로 데이터를 보내기 위한 경로 설정과 논리 주소 설정
    - 예시 : IP
    - 단위 : 패킷
    - 기능 : 데이터를 전송하려면 여러 중계기(라우터)를 거쳐야 하는데 어떤 중계 시스템을 거치는 지에 대한 정보 제공(라우팅 기능)
        - 라우터 : 올바른 경로를 선택할 수 있도록 지원
            - 라우팅 테이블 : 네트워크 구성 형태에 관한 정보를 관리하는 공간
            - 정적 라우팅 : 패킷 전송이 이루어지기 전에 경로 정보를 라우터가 미리 저장하여 중개
                - 경로 정보의 갱신이 어려워 네트워크 변화나 혼란에 대처하기 어렵다.
            - 동적 라우팅 : 라우터의 경로 정보를 네트워크 상황에 따라 적절하게 변경
                - 복잡한 작업 및 경로 정보 수집으로 인한 오버헤드로 성능 저하 발생
        - 혼잡 제어 : 네트워크에 패킷 수가 과도하게 증가되는 현상을 예방하거나 제거
        - IP 프로토콜 : 인터넷 환경에서 네트워크 계층의 데이터 전송 프로토콜
            - 비연결형 서비스이고 패킷 분할/병합 기능 수행
            - 전송 패킷이 수신 호스트에 100% 도착하는 것을 보장하지 않는다.
            - IP 주소 = 네트워크 주소 + 호스트 주소
                - 각 나라의 공인 기관에서 할당 / 관리
                - IPv4 주소 : 32bit 주소 공간 (2^32)
                - IPv6 주소 : 128bit 주소 공간 (2^128)
        - ICMP 프로토콜 : 인터넷 환경에서 오류ㅔ에 관한 처리

7. 데이터 링크 계층 : 데이터 전송과정에서 발생할 수 있는 오류 처리하고 물리 주소 결정
    - 예시
        - ARP 프로토콜 : IP 주소를 MAC 주소로 바꾸어주는 프로토콜
        - RARP 프로토콜 : MAC 주소를 IP 주소로 바꾸어주는 프로토콜
    - 단위 : 프레임
    - 기능 : LAN 카드 별로 MAC 주소 관리
        - 긍정 응답 프레임(ACK 프레임) : 전송 데이터가 올바르게 도착했음을 회신
        - 부정 응답 프레임(NAK 프레임) : 전송 데이터가 깨져서 도착했음을 회신
        - 슬라이딩 윈도우 프로토콜 : 두 호스트 간 데이터 전송을 위한 일반적인 통신 프로토콜 (오류 제어, 흐름 제어 지원)
            1) 송신 호스트는 정보 프레임(전송 데이터, 데이터 순서, 오류 검출 코드)을 순서 번호에 따라 순차적 전송
            2) 송신 호스트는 전송 데이터를 내부 버퍼인 송신 윈도우에 저장
            3) 수신 호스트는 ACK 프레임과 다음 순서 정보를 전송
            4) 수신 호스트는 수신 데이터를 내부 버퍼인 수신 윈도우에 저장

8. 물리 계층 : 시스템을 물리적으로 연결하고 전기 신호를 변환 및 전송
    - 예시 : Ethernet
    - 기능 : 호스트와 전송매체를 연결하기 위해 인터페이스 규칙과 전송 매체 특성을 다룬다. 유일하게 하드웨어로 구현되어 있다. 